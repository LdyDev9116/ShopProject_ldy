<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Around | Shop Catalog</title>
  <!-- SEO Meta Tags-->
  <meta name="description" content="Around - Multipurpose Bootstrap HTML Template">
  <meta name="keywords" content="bootstrap, business, corporate, coworking space, services, creative agency, dashboard, e-commerce, mobile app showcase, saas, multipurpose, product landing, shop, software, ui kit, web studio, landing, dark mode, html5, css3, javascript, gallery, slider, touch, creative">
  <meta name="author" content="Createx Studio">
  <!-- Viewport-->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Favicon and Touch Icons-->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="/assets/favicon/site.webmanifest">
  <link rel="mask-icon" color="#6366f1" href="/assets/favicon/safari-pinned-tab.svg">
  <meta name="msapplication-TileColor" content="#080032">
  <meta name="msapplication-config" content="/assets/favicon/browserconfig.xml">
  <meta name="theme-color" content="white">
  <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>

  <style>
    .page-loading {
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100%;
      -webkit-transition: all .4s .2s ease-in-out;
      transition: all .4s .2s ease-in-out;
      background-color: #fff;
      opacity: 0;
      visibility: hidden;
      z-index: 9999;
    }

    .dark-mode .page-loading {
      background-color: #121519;
    }

    .page-loading.active {
      opacity: 1;
      visibility: visible;
    }

    .page-loading-inner {
      position: absolute;
      top: 50%;
      left: 0;
      width: 100%;
      text-align: center;
      -webkit-transform: translateY(-50%);
      transform: translateY(-50%);
      -webkit-transition: opacity .2s ease-in-out;
      transition: opacity .2s ease-in-out;
      opacity: 0;
    }

    .page-loading.active>.page-loading-inner {
      opacity: 1;
    }

    .page-loading-inner>span {
      display: block;
      font-family: 'Inter', sans-serif;
      font-size: 1rem;
      font-weight: normal;
      color: #6f788b;
    }

    .dark-mode .page-loading-inner>span {
      color: #fff;
      opacity: .6;
    }

    .page-spinner {
      display: inline-block;
      width: 2.75rem;
      height: 2.75rem;
      margin-bottom: .75rem;
      vertical-align: text-bottom;
      background-color: #d7dde2;
      border-radius: 50%;
      opacity: 0;
      -webkit-animation: spinner .75s linear infinite;
      animation: spinner .75s linear infinite;
    }

    .dark-mode .page-spinner {
      background-color: rgba(255, 255, 255, .25);
    }

    @-webkit-keyframes spinner {
      0% {
        -webkit-transform: scale(0);
        transform: scale(0);
      }

      50% {
        opacity: 1;
        -webkit-transform: none;
        transform: none;
      }
    }

    @keyframes spinner {
      0% {
        -webkit-transform: scale(0);
        transform: scale(0);
      }

      50% {
        opacity: 1;
        -webkit-transform: none;
        transform: none;
      }
    }

    /* 배너이미지 조정 내꺼임 */
    .custom-margin {
      margin-top: 70px;
      /* 상단 여백 추가 */
    }

    .card-hover.bg-secondary {
      background-color: white !important;
      /* !important를 사용하여 우선 순위를 강제합니다. */
    }
    /* 배너이미지 조정 내꺼임 */
    /* Correcting top-nav positioning 로그인 */
    .text-button {
      background: none;
      border: none;
      color: inherit;
      font: inherit;
      cursor: pointer;
      padding: 0;
      margin: 0;
    }

    .time-extend-container { /* 한줄로 표기*/
      display: flex;
      align-items: center; /* 텍스트를 아래로 정렬 */
    }

    .remaining-time {
      margin-right: 10px; /* 여백 조절 */
      padding-top: 20px; /* 텍스트를 아래로 내리기 위한 패딩 조절 */
    }

    .top-nav {
      position: absolute;
      top: 10px;
      right: 200px;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      padding: 10px 20px;
      font-size: 14px; /* 동일한 글씨 크기 적용 */
    }
    .top-nav a {
      margin: 0 10px;
      text-decoration: none;
      color: #555;
      font-size: 14px; /* 동일한 글씨 크기 적용 */
    }

    .top-nav a:hover {
      text-decoration: underline;
    }

    .dropdown {
      position: relative;
      display: inline-block;
      font-size: 14px; /* 동일한 글씨 크기 적용 */
      margin: 0 10px; /* 다른 항목들과 동일한 간격 유지 */
    }

    .dropdown-content {
      display: none;
      position: absolute;
      right: 0;
      background-color: #f8f8f8;
      min-width: 160px;
      box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
      z-index: 1;
      font-size: 14px; /* 동일한 글씨 크기 적용 */
    }

    .dropdown-content a {
      color: #555;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
      font-size: 14px; /* 동일한 글씨 크기 적용 */
    }

    .dropdown-content a:hover {
      background-color: #ddd;
    }

    .dropdown:hover .dropdown-content {
      display: block;
    }
    /* (기존 CSS 코드 유지) */
    /* 배너이미지 조정 내꺼임 */
    .custom-margin {
      margin-top: 70px;
      /* 상단 여백 추가 */
    }

    .card-hover.bg-secondary {
      background-color: white !important;
      /* !important를 사용하여 우선 순위를 강제합니다. */
    }

    /* Correcting top-nav positioning 로그인 */
    /* 주문결제하기 css */
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
    }
    .container {
      margin-top: 30px;
    }
    .section-title {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 10px;
      border-bottom: 2px solid #ff6b00;
      padding-bottom: 5px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .total-price {
      font-size: 18px;
      font-weight: bold;
      color: #ff6b00;
      text-align: right;
    }
    .btn-order {
      background-color: #ff6b00;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      width: 100%;
      text-align: center;
      margin-top: 20px;
    }
    .btn-order:hover {
      background-color: #e65a00;
    }
    .coupon-section input {
      display: inline-block;
      width: 80px;
      margin-right: 10px;
    }
    .coupon-section button {
      margin-top: 10px;
    }
    .payment-methods button {
      margin-top: 10px;
      width: 100%;
      text-align: left;
    }
    .card-selection, .installment-selection, .naverpay-message, .banktransfer-message, .kakaopay-message {
      display: none;
      margin-top: 20px;
    }
    .naverpay-message, .banktransfer-message, .kakaopay-message {
      background-color: #f8f8f8;
      padding: 10px;
      border-radius: 5px;
      color: #333;
      font-size: 14px;
    }
    .order-summary {
      width: 100%;
    }
    .order-items img {
      width: 50px;
      height: 50px;
      margin-right: 10px;
    }
    .order-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #ddd;
      padding: 10px 0;
    }
    .order-item:last-child {
      border-bottom: none;
    }
    .order-item-info {
      flex-grow: 1;
    }
    .order-item-price {
      text-align: right;
    }
    .info-group {
      margin-bottom: 10px;
      display: flex;
      align-items: center;
    }
    .info-group span {
      font-weight: bold;
      width: 120px; /* 라벨의 너비 설정 */
      text-align: right;
      margin-right: 10px;
    }
    .info-input {
      flex-grow: 1;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .btn-manage-address {
      background-color: #343a40 !important;
      color: white !important;
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
    }

    .btn-manage-address:hover {
      background-color: #23272b;
    }
    .btn-link {
      color: #ff6b00;
    }
    .btn-link:hover {
      color: #e65a00;
    }
    .btn-primary {
      background-color: #ff6b00 !important; /* 원하는 색상으로 변경 */
      border-color: #ff6b00 !important; /* 원하는 색상으로 변경 */
    }
    .btn-primary:hover {
      background-color: #e65a00 !important; /* 원하는 색상으로 변경 */
      border-color: #e65a00 !important; /* 원하는 색상으로 변경 */
    }
    .btn-primary:focus, .btn-primary:active {
      background-color: #ff6b00 !important; /* 원하는 색상으로 변경 */
      border-color: #ff6b00 !important; /* 원하는 색상으로 변경 */
      box-shadow: none !important;
    }
    .modal-content {
      position: relative;
      padding: 30px;
      width: 580px;
      height: 800px;
      box-sizing: border-box;
      border-radius: 20px;
    }
    .address-card {
      border: 1px solid #ff6b00;
      border-radius: 5px;
      padding: 10px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .address-details {
      flex-grow: 1;
    }
    .badge {
      background-color: #ff6b00;
      color: white;
      padding: 5px 10px;
      border-radius: 5px;
      margin-right: 5px;
    }
    .btn-edit, .btn-delete {
      background-color: #f8f8f8;
      border: 1px solid #ccc;
      padding: 5px 8px;
      border-radius: 5px;
      cursor: pointer;
      margin-right: 5px;
      display: flex;
      align-items: center;
      margin-top: 10px;
    }
    .btn-edit:hover, .btn-delete:hover {
      background-color: #e7e7e7;
    }

    /* order-summary-container 클래스 추가 */
    .order-summary-container {
      width: 80%;
      position: sticky;
      top: 20px;
    }
    /* 결제방법 선택 색깔 */
    .payment-methods button.selected {
      border-color: #ff6b00;
    }
    /* 주문결제하기 css */

  </style>
  <!-- Import 아임포트 라이브러리 -->
  <script src="https://cdn.iamport.kr/v1/iamport.js"></script>
  <!-- Page loading scripts-->
  <script>
    // 포트원(PortOne) 초기화 (가맹점 고유 코드)
    IMP.init("imp22862720");  // 실제 가맹점 식별 코드를 넣으세요

    (function () {
      window.onload = function () {
        const preloader = document.querySelector('.page-loading');
        preloader.classList.remove('active');
        setTimeout(function () {
          preloader.remove();
        }, 1500);
      };
    })();
  </script>

  <!-- Import Google Font-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet" id="google-font">
  <!-- Vendor styles 상대경로로 바꿈 이상하게 적용이래야됨-->
  <link rel="stylesheet" media="screen" href="/assets/vendor/nouislider/dist/nouislider.min.css" />
  <link rel="stylesheet" media="screen" href="/assets/vendor/swiper/swiper-bundle.min.css" />
  <!-- Main Theme Styles + Bootstrap 상대경로로 바꿈 이상하게 적용이래야됨-->
  <link rel="stylesheet" media="screen" href="/assets/css/theme.min.css">
  <!-- 제이쿼리사용시 필요 -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<!-- Body-->

<body>
<!-- Page loading spinner-->
<div class="page-loading active">
  <div class="page-loading-inner">
    <div class="page-spinner"></div><span>Loading...</span>
  </div>
</div>
<!-- Page wrapper-->
<main class="page-wrapper">
  <!-- Search modal-->
  <div class="modal fade" id="searchModal" tabindex="-1" role="dialog" data-focus-input="#search">
    <div class="modal-dialog modal-dialog-scrollable" role="document">
      <div class="modal-content">
        <div class="modal-header d-block position-relative border-0 pb-3">
          <form class="position-relative w-100 mt-2 mb-4">
            <button class="btn-close position-absolute top-50 end-0 translate-middle-y m-0 me-n1" type="reset" data-bs-dismiss="modal"></button><i class="ai-search fs-xl position-absolute top-50 start-0 translate-middle-y ms-3"></i>
            <input class="form-control form-control-lg px-5" type="search" placeholder="Type to search" data-focus-on-open="[&quot;modal&quot;, &quot;#searchModal&quot;]">
          </form>
          <div class="fs-xs fw-medium text-muted text-uppercase">Suggestions</div>
        </div>
        <div class="modal-body pt-3">
          <div class="d-flex align-items-center border-bottom pb-4 mb-4"><a class="position-relative d-inline-block flex-shrink-0 bg-secondary rounded-1" href="shop-single.html"><span class="badge bg-success position-absolute top-0 start-100 translate-middle ms-n1">Shop</span><img src="/assets/img/shop/products/01.png" width="90" alt="Product"></a>
            <div class="ps-3">
              <h4 class="h6 mb-2"><a href="shop-single.html">매콤 오징어 떡볶이</a></h4><span class="mb-0 me-2">9900원</span>
              <del class="fs-sm text-muted ms-auto">12900원</del>
            </div>
          </div>
          <div class="d-flex align-items-center border-bottom pb-4 mb-4"><a class="position-relative d-inline-block flex-shrink-0" href="#"><span class="badge bg-info position-absolute top-0 start-100 translate-middle ms-n1">Blog</span><img class="rounded-1" src="/assets/img/landing/shop/instagram/02.jpg" width="90" alt="Post"></a>
            <div class="ps-3">
              <h4 class="h6 mb-0"><a href="#">밀키트맛있는. Tips &amp; 살짝매콤.</a></h4>
            </div>
          </div>
          <div class="d-flex align-items-center"><a class="position-relative d-inline-block flex-shrink-0 bg-secondary rounded-1" href="shop-single.html"><span class="badge bg-success position-absolute top-0 start-100 translate-middle ms-n1">Shop</span><img src="/assets/img/shop/products/06.png" width="90" alt="Product"></a>
            <div class="ps-3">
              <h4 class="h6 mb-2"><a href="shop-single.html">오징어 해물 파전 검색</a></h4><span class="mb-0 me-2">6600원</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Cart offcanvas-->
  <div class="offcanvas offcanvas-end py-2 p-sm-4 p-md-5" id="cartOffcanvas" style="width: 680px;">
    <!-- Title-->
    <div class="px-4 pt-3">
      <div class="d-flex justify-content-between align-items-center border-bottom pb-3 pb-sm-4">
        <h2 class="offcanvas-title d-flex align-items-center mb-1">Your cart <span class="fs-base fw-normal text-muted ms-3">(3 items)</span></h2>
        <button class="btn-close mb-1 me-n1" type="button" data-bs-dismiss="offcanvas" data-bs-target="#cartOffcanvas"></button>
      </div>
    </div>

    <!-- Item-->
    <div class="d-sm-flex align-items-center border-top pt-4"><a class="d-inline-block flex-shrink-0 bg-secondary rounded-1 p-sm-2 p-md-3 mb-2 mb-sm-0" href="shop-single.html"><img src="/assets/img/shop/cart/03.png" width="110" alt="Product"></a>
      <div class="w-100 pt-1 ps-sm-4">
        <div class="d-flex">
          <div class="me-3">
            <h3 class="h5 mb-2"><a href="shop-single.html">Set for a dinner party of 7 items</a></h3>
          </div>
          <div class="text-end ms-auto">
            <div class="fs-5 mb-2">$47.00</div>
          </div>
        </div>
        <div class="count-input ms-n3">
          <button class="btn btn-icon fs-xl" type="button" data-decrement>-</button>
          <input class="form-control" type="number" value="1" readonly>
          <button class="btn btn-icon fs-xl" type="button" data-increment>+</button>
        </div>
        <div class="nav justify-content-end mt-n5 mt-sm-n3"><a class="nav-link fs-xl p-2" href="#" data-bs-toggle="tooltip" title="Remove"><i class="ai-trash"></i></a></div>
      </div>
    </div>
  </div>
  <!-- Coupon input + total-->
  <div class="px-4 pb-3 pb-sm-4 pb-sm-5">
    <div class="d-sm-flex align-items-center border-top pt-4">
      <div class="input-group input-group-sm border-dashed mb-3 mb-sm-0 me-sm-4 me-md-5">
        <input class="form-control text-uppercase" type="text" placeholder="Your coupon code">
        <button class="btn btn-secondary" type="button">Apply coupon</button>
      </div>
      <div class="d-flex align-items-center justify-content-center"><span class="fs-xl me-3">Total:</span><span class="h3 mb-0">$92.00</span></div>
    </div>
  </div>
  <!-- Action buttons-->
  <div class="d-flex align-items-center justify-content-between px-4 pb-3">
    <div class="nav d-none d-sm-block"><a class="nav-link fw-semibold px-0" href="#cartOffcanvas" data-bs-dismiss="offcanvas"><i class="ai-chevron-left fs-xl me-2"></i>Back to shop</a></div><a class="btn btn-lg btn-primary w-100 w-sm-auto" href="shop-checkout.html">Proceed to checkout<i class="ai-chevron-right ms-2 me-n1"></i></a>
  </div>
  </div>
  <!-- Navbar. Remove 'fixed-top' class to make the navigation bar scrollable with the page-->
  <header class="navbar navbar-expand-lg fixed-top bg-light">
    <!-- 페이지 이동  로그인-->
    <div class="top-nav" th:if="${isLoggedIn != null && isLoggedIn}">
      <a th:href="@{/account-signout}" class="nav-link p-2">로그아웃</a> |
      <a th:href="@{/account-profile}" class="nav-link p-2">마이페이지</a> |
      <div class="time-extend-container">
        <p class="remaining-time">&nbsp; 남은 시간: <span id="remainingTime" data-remaining-time="${remainingTime}"></span></p>
        <button id="extendTokenBtn" class="text-button">로그인 연장 &nbsp; </button> |
      </div>
      <div class="dropdown">
        <a href="javascript:void(0)">고객센터 ▼</a>
        <div class="dropdown-content">
          <a href="#">문의하기</a>
          <a href="#">FAQ</a>
          <a href="#">지원 센터</a>
        </div>
      </div>
    </div>
    <div class="top-nav" th:if="${isLoggedIn == null || !isLoggedIn}">
      <a th:href="@{/account-signup}" class="nav-link p-2">회원가입</a> |
      <a th:href="@{/account-signin}" class="nav-link p-2">로그인</a> |
      <div class="dropdown">
        <a href="javascript:void(0)">고객센터 ▼</a>
        <div class="dropdown-content">
          <a href="#">문의하기</a>
          <a href="#">FAQ</a>
          <a href="#">지원 센터</a>
        </div>
      </div>
    </div>


    <div class="container"><a class="navbar-brand pe-sm-3" href="main"><span class="text-primary flex-shrink-0 me-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="200" height="200">
                <a href="main"><image xlink:href="/assets/img/shop/logo_최종.png" width="120" height="120" x="70" y="50" /></a>
            </svg></span><span class="d-none d-sm-inline">Fresh kit</span></a>

      <div class="nav align-items-center order-lg-3 ms-n1 me-3 me-sm-0">
        <a class="nav-link fs-4 p-2 mx-sm-1" href="#searchModal" data-bs-toggle="modal">
          <i class="ai-search"></i>
        </a>
        <a class="nav-link fs-4 p-2 mx-sm-1 d-none d-sm-flex" href="/account-signin"><i class="ai-user"></i></a>
        <a class="nav-link position-relative fs-4 p-2" href="#cartOffcanvas" data-bs-toggle="offcanvas">
          <i class="ai-cart"></i><span class="badge bg-primary fs-xs position-absolute end-0 top-0 me-n1" style="padding: .25rem .375rem;">3</span>
        </a>
      </div>
      <button class="navbar-toggler ms-sm-3" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"><span class="navbar-toggler-icon"></span></button>
      <nav class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav navbar-nav-scroll me-auto" style="--ar-scroll-height: 520px;">
          <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown" aria-expanded="false">카테고리</a>
            <div class="dropdown-menu overflow-hidden p-0">
              <div class="d-lg-flex">
                <div class="mega-dropdown-column pt-1 pt-lg-3 pb-lg-4">
                  <ul class="list-unstyled mb-0">
                    <li><a class="dropdown-item" href="prd3">전체</a><span class="mega-dropdown-column position-absolute top-0 end-0 h-100 bg-size-cover bg-repeat-0 rounded-3 rounded-start-0" ></span></li>
                    <li><a class="dropdown-item" href="prd3">양식</a><span class="mega-dropdown-column position-absolute top-0 end-0 h-100 bg-size-cover bg-repeat-0 rounded-3 rounded-start-0" ></span></li>
                    <li><a class="dropdown-item" href="prd3">한식</a><span class="mega-dropdown-column position-absolute top-0 end-0 h-100 bg-size-cover bg-repeat-0 rounded-3 rounded-start-0" ></span></li>
                  </ul>
                </div>
                <div class="mega-dropdown-column pb-2 pt-lg-3 pb-lg-4">
                  <ul class="list-unstyled mb-0">
                    <li><a class="dropdown-item" href="prd3">중식/ 일식</a><span class="mega-dropdown-column position-absolute top-0 end-0 h-100 bg-size-cover bg-repeat-0 zindex-2 opacity-0" style="background-image: url(/assets/img/megamenu/web-studio.jpg);"></span></li>
                    <li><a class="dropdown-item" href="prd3">분식</a><span class="mega-dropdown-column position-absolute top-0 end-0 h-100 bg-size-cover bg-repeat-0 zindex-2 opacity-0" style="background-image: url(/assets/img/megamenu/web-studio.jpg);"></span></li>
                  </ul>
                </div>
                <div class="mega-dropdown-column position-relative border-start zindex-3"></div>
              </div>
            </div>
          </li>

          <li class="nav-item"><a class="nav-link" href="prd3">신제품 </a></li>
          <li class="nav-item"><a class="nav-link" href="prd3">베스트</a></li>
          <li class="nav-item"><a class="nav-link" href="prd3">특가</a></li>
          <li class="nav-item"><a class="nav-link" href="prd3">이벤트</a></li>
          <li class="nav-item border-top mt-2 py-2 d-sm-none"><a class="nav-link" href="profile"><i class="ai-user fs-lg me-2"></i>Sign In</a></li>
        </ul>
        <div class="d-sm-none p-3 mt-n3"><a class="btn btn-primary w-100  mb-1" href="https://themes.getbootstrap.com/product/around-multipurpose-template-ui-kit/" target="_blank" rel="noopener"><i class="ai-cart fs-xl me-2 ms-n1"></i>Buy now</a></div>
      </nav>
    </div>
  </header>
  <!-- Page content-->
  <!-- <div class="container py-5 mt-5 mb-lg-4 mb-xl-5"> -->
  <div class="container py-5 mt-5 mb-lg-4 mb-xl-5" style="max-width: 2400px;">
    <nav aria-label="breadcrumb">
      <ol class="pt-lg-3 pb-2 breadcrumb">
        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
        <li class="breadcrumb-item active" aria-current="page">order-summary</li>
      </ol>
    </nav>
    <form id="paymentForm" action="/create-payment" method="post">
      <div class="row">
        <div class="col-md-6" style="margin-left: 200px">
          <div class="card mb-4">
            <div class="card-body">
              <div class="section">
                <div class="section-title">
                  배송지 정보
                  <button class="btn btn-manage-address" type="button" data-bs-toggle="modal" data-bs-target="#addressModal">배송지관리</button>
                </div>
                <div class="info-group">
                  <span>받는분:</span>
                  <input type="text" class="form-control info-input" id="recipientNameInput" name="recipientNameInput" th:value="${username}">
                </div>
                <div class="info-group">
                  <span>주소:</span>
                  <input type="text" class="form-control info-input" id="address" name="address" th:value="${addressLine1}">
                </div>
                <div class="info-group">
                  <span>상세주소:</span>
                  <input type="text" class="form-control info-input" id="detailAddress" name="detailAddress" th:value="${addressLine2}">
                </div>
                <div class="info-group">
                  <span>우편번호:</span>
                  <input type="text" class="form-control info-input" id="postcode" name="postcode" th:value="${postalCode}">
                </div>
                <div class="info-group">
                  <span>휴대폰:</span>
                  <input type="text" class="form-control info-input" id="phoneNumber" name="phoneNumber" th:value="${userphone}">
                </div>
                <div class="info-group">
                  <span>이메일:</span>
                  <input type="email" class="form-control info-input" id="emailAddress" name="emailAddress" th:value="${useremail}">
                </div>
                <div class="info-group">
                  <span>배송희망일:</span>
                  <input type="date" class="form-control info-input" id="deliveryDate" name="deliveryDate" style="width:auto;">
                </div>
                <div class="info-group">
                  <span>배송요청사항:</span>
                  <select class="form-control info-input" id="shippingRequest" name="shippingRequest" onchange="toggleCustomMessageInput()" style="width:auto;">
                    <option value="">메시지를 선택해 주세요</option>
                    <option value="직접입력">직접입력</option>
                    <option value="배송 전, 연락 부탁드립니다.">배송 전, 연락 부탁드립니다.</option>
                    <option value="부재시, 전화 또는 문자 주세요.">부재시, 전화 또는 문자 주세요.</option>
                    <option value="부재시, 경비실(관리실)에 맡겨주세요.">부재시, 경비실(관리실)에 맡겨주세요.</option>
                  </select>
                </div>
                <div class="info-group" id="customMessageContainer" style="display:none;">
                  <span>직접 입력:</span>
                  <input type="text" class="form-control info-input" id="customMessage" name="customMessage" placeholder="배송 요청 사항을 입력하세요" style="width:auto;">
                </div>
              </div>
            </div>
          </div>

          <!-- 주문 상품 카드 -->
          <div class="card mb-4">
            <div class="card-body">
              <div class="section-title">주문 상품</div>
              <div class="order-items">
                <!-- 타임리프를 사용하여 orderItems 리스트 렌더링 -->
                <div th:each="item : ${order.orderItems}"
                     class="order-item"
                     th:data-product-id="${item.productId}"
                     th:data-product-name="${item.productName}"
                     th:data-quantity="${item.quantity}"
                     th:data-price="${item.price}">
                  <div class="order-item-info">
                    <strong th:text="${item.productName}"></strong>
                  </div>
                  <div class="order-item-price">
                    <span th:text="${item.quantity} + '개'"></span><br>
                    <span th:text="${item.price} + '원'"></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="card mb-4">
            <div class="card-body">
              <div class="section-title">결제방법</div>
              <div class="payment-methods">
                <!-- 실시간 -->
                <button type="button" id="kakaopay" class="btn btn-outline-secondary" onclick="selectPaymentMethod('kakaopay')">카카오페이</button>
                <button type="button" id="banktransfer" class="btn btn-outline-secondary" onclick="selectPaymentMethod('banktransfer')">실시간계좌이체</button>
                <button type="button" id="naverpay" class="btn btn-outline-secondary" onclick="selectPaymentMethod('naverpay')">네이버페이</button>
                <button type="button" id="creditcard" class="btn btn-outline-secondary" onclick="selectPaymentMethod('creditcard')">신용카드</button>
                <button type="button" id="mobile" class="btn btn-outline-secondary" onclick="selectPaymentMethod('mobile')">휴대폰결제</button>
              </div>
              <div class="card-selection">
                <div class="form-group mt-3">
                  <label for="card-select">카드선택</label>
                  <select class="form-control" id="card-select" name="card-select">
                    <option>[필수] 카드를 선택하세요.</option>
                    <option>신한카드</option>
                    <option>국민카드</option>
                    <option>삼성카드</option>
                  </select>
                </div>
                <div class="form-group mt-3">
                  <label for="installment-select">할부선택</label>
                  <select class="form-control" id="installment-select" name="installment-select">
                    <option>일시불</option>
                    <option>2개월</option>
                    <option>3개월</option>
                  </select>
                </div>
              </div>
              <div class="naverpay-message">
                *네이버 페이 결제시 삼성카드 My큐커플랜 이용실적에 포함되지 않습니다.
              </div>
              <div class="kakaopay-message">
                *카카오 페이 결제시 삼성카드 My큐커플랜 이용실적에 포함되지 않습니다.
              </div>
              <div class="banktransfer-message">
                국민은행 933502 - 00 - 029356<br>
                당일이체 기준은 오전 12시 기준으로 당일배송과 명일배송으로 분리됩니다.
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="order-summary-container sticky-top">
            <div class="order-summary">
              <div class="card">
                <div class="card-body">
                  <div class="section-title">주문결제 금액</div>
                  <ul class="list-group">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                      상품금액
                      <span th:text="${order.totalPrice} + ' 원'"></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                      할인금액
                      <span>0 원</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                      배송비
                      <span th:if="${order.totalPrice <= 40000}" th:text="'3,000 원'"></span>
                      <span th:if="${order.totalPrice > 40000}" th:text="'0 원'"></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                      <strong>총 결제 금액</strong>
                      <strong th:if="${order.totalPrice <= 40000}" th:text="${order.totalPrice + 3000} + ' 원'"></strong>
                      <strong th:if="${order.totalPrice > 40000}" th:text="${order.totalPrice} + ' 원'"></strong>
                    </li>
                    <input type="hidden" id="totalPriceValue" name="totalPriceValue" th:value="${order.totalPrice}">
                    <input type="hidden" id="phone" name="phone" th:value="${userphone}">
                    <input type="hidden" id="email" name="email" th:value="${useremail}">
                    <input type="hidden" id="recipientName" name="recipientName" th:value="${username}">
                    <input type="hidden" id="pointAmount" name="pointAmount" value="0">
                    <div th:if="${#lists.size(order.orderItems) > 0}">
                      <input type="hidden" id="productName" name="productName" th:value="${order.orderItems[0].productName}">
                    </div>
                  </ul>
                  <div class="form-check my-3">
                    <input type="checkbox" class="form-check-input" id="agreement" name="agreement">
                    <label class="form-check-label" for="agreement">구매조건 및 이용약관에 동의하며, 결제를 진행합니다.</label>
                  </div>
                  <input type="hidden" id="impUid" name="impUid">
                  <input type="hidden" id="merchantUid" name="merchantUid">
                  <input type="hidden" id="paidAmount" name="paidAmount">
                  <button type="submit" class="btn-order" id="orderButton">결제하기</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>

          <!-- Address Management Modal -->
          <div class="modal fade" id="addressModal" tabindex="-1" aria-labelledby="addressModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="addressModalLabel">배송지 관리</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <div id="addressList">
                    <!-- 기본 배송지 카드 -->
                    <div class="address-card" onclick="selectAddress(this)">
                      <div class="address-details">
                        <strong>용한빈</strong>
                        <span class="badge">기본배송지</span>
                        <span class="badge">택배배송</span>
                        <p>16889<br>경기 용인시 수지구 죽전로 143<br>우미이노스빌101동1003호<br>010-1234-5678</p>
                      </div>
                      <div>
                        <button class="btn-edit" onclick="editAddress(this, event)">
                          <i class="fas fa-edit"></i> 수정
                        </button>
                        <button class="btn-delete" onclick="deleteAddress(this)">
                          <i class="fas fa-trash-alt"></i> 삭제
                        </button>
                      </div>
                    </div>
                    <!--메인화면 처음 보이는곳  -->
                    <button type="button" class="btn btn-primary" onclick="showNewAddressForm()">새 주소 추가</button>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                    <button type="button" class="btn btn-primary" onclick="confirmAddress()">선택 완료</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- New Address Modal -->
            <div class="modal fade" id="newAddressModal" tabindex="-1" aria-labelledby="newAddressModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-lg">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="newAddressModalLabel">새 주소 추가</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <div class="info-group">
                      <span>이름:</span><input type="text" class="form-control info-input" id="newName" name="newName">
                    </div>
                    <div class="info-group">
                      <span>받는분:</span><input type="text" class="form-control info-input" id="newRecipient" name="newRecipient">
                    </div>
                    <div class="info-group">
                      <span>우편번호:</span>
                      <input type="text" class="form-control info-input" id="newZipCode" name="newZipCode" readonly>
                      <button type="button" class="btn btn-primary" onclick="execDaumPostcode()">우편번호 검색</button>
                    </div>
                    <div class="info-group">
                      <span>주소:</span>
                      <input type="text" class="form-control info-input" id="newAddress" name="newAddress" disabled>
                    </div>
                    <div class="info-group">
                      <span>상세주소:</span>
                      <input type="text" class="form-control info-input" id="newDetailAddress" name="newDetailAddress">
                    </div>
                    <div class="info-group">
                      <span>휴대폰:</span>
                      <input type="text" class="form-control info-input" id="newPhone" name="newPhone">
                    </div>
                    <div class="form-check">
                      <input type="checkbox" class="form-check-input" id="defaultAddressCheck" name="defaultAddressCheck">
                      <label class="form-check-label" for="defaultAddressCheck">기본 배송지로 설정</label>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="addNewAddress()">추가</button>
                  </div>
                </div>
              </div>
            </div>
            <!-- ... [기존 모달 코드] ... -->
            <!-- Content 영역 -->
          </div>
        </div>
      </div>
    </form>
  </div>
  <!-- Sidebar toggle button-->
  <button class="d-lg-none btn btn-sm fs-sm btn-primary w-100 rounded-0 fixed-bottom" data-bs-toggle="offcanvas" data-bs-target="#shopSidebar"><i class="ai-filter me-2"></i>Filters</button>
</main>
<!-- Footer-->
<footer class="footer bg-dark position-relative pb-4 pt-md-3 py-lg-4 py-xl-5">
  <div class="d-none d-dark-mode-block position-absolute top-0 start-0 w-100 h-100" style="background-color: rgba(255,255,255, .02);"></div>
  <div class="dark-mode container position-relative zindex-2 pt-5 pb-2">
    <!-- Columns with links-->
    <div class="row" id="links">
      <div class="col-md-3 col-xl-2 pb-2 pb-md-0">
        <h3 class="h6 text-uppercase d-none d-md-block">유용한 링크</h3><a class="btn-more h6 mb-1 text-uppercase text-decoration-none d-flex align-items-center collapsed d-md-none" href="#useful" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="useful" data-show-label="Useful links" data-hide-label="Useful links"></a>
        <div class="collapse d-md-block" id="useful" data-bs-parent="#links">
          <ul class="nav flex-column pb-2 pb-md-0">
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">인기 급상승</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">판매</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">회사소개</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">블로그</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">연락하다</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">배송 및 &amp; 반품</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">배송정보</a></li>
          </ul>
        </div>
      </div>
      <div class="col-md-3 col-xl-2 pb-2 pb-md-0">
        <h3 class="h6 text-uppercase d-none d-md-block">카테고리</h3><a class="btn-more h6 mb-1 text-uppercase text-decoration-none d-flex align-items-center collapsed d-md-none" href="#decors" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="decors" data-show-label="Decors" data-hide-label="Decors"></a>
        <div class="collapse d-md-block" id="decors" data-bs-parent="#links">
          <ul class="nav flex-column pb-2 pb-md-0">
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">신제품</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">베스트</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">특가</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">선물하기</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">이벤트</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">단체주문</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">추천제품</a></li>
          </ul>
        </div>
      </div>
      <div class="col-md-3 col-xl-2 pb-2 pb-md-0">
        <h3 class="h6 text-uppercase d-none d-md-block">고객센터</h3><a class="btn-more h6 mb-1 text-uppercase text-decoration-none d-flex align-items-center collapsed d-md-none" href="#categories" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="categories" data-show-label="Categories" data-hide-label="Categories"></a>
        <div class="collapse d-md-block" id="categories" data-bs-parent="#links">
          <ul class="nav flex-column pb-2 pb-md-0">
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">일대일 문의하기</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">대량구매 문의</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">공지사항</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#"></a>자주 묻는 질의</li>
          </ul>
        </div>
      </div>
      <div class="col-md-3 pb-2 pb-md-0">
        <h3 class="h6 text-uppercase d-none d-md-block">회사소개</h3><a class="btn-more h6 mb-1 text-uppercase text-decoration-none d-flex align-items-center collapsed d-md-none" href="#showroom" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="showroom" data-show-label="Showroom" data-hide-label="Showroom"></a>
        <div class="collapse d-md-block" id="showroom" data-bs-parent="#links">
          <ul class="nav flex-column pb-3">
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="#">경기도 성남시 중원구 갈마치로 288번길 26(상대원동)</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="mailto:email@example.com">tmznf91116@naver.com</a></li>
            <li class="nav-item"><a class="nav-link fw-normal px-0 py-1" href="+1544 1004">1544 - 1004</a></li>
          </ul>
          <ul class="list-unstyled mb-0 pb-3 pb-md-0">
            <li class="text-nav mb-2">월 ~ 금: 8:00 - 21:00</li>
            <li class="text-nav mb-2">토요일: 8:00 - 21:00</li>
            <li class="text-nav">일요일: 8:00 - 21:00</li>
          </ul>
        </div>
      </div>
      <div class="col-12 col-xl-3 mt-md-2 mt-xl-0 pt-2 pt-md-4 pt-xl-0">
        <h3 class="h6 text-uppercase mb-1 pb-1">앱 다운로드</h3>
        <div class="d-flex d-xl-block d-xxl-flex"><a class="btn btn-secondary px-3 py-2 mt-3 me-3" href="#"><img class="mx-1" src="/assets/img/market/appstore-light.svg" width="120" alt="App Store"></a><a class="btn btn-secondary px-3 py-2 mt-3" href="#"><img class="mx-1" src="/assets/img/market/googleplay-light.svg" width="119" alt="Google Play"></a></div>
      </div>
    </div>
    <!-- Nav + Switcher-->
    <div class="d-sm-flex align-items-end justify-content-between border-bottom mt-2 mt-sm-1 pt-4 pt-sm-5">
      <!-- Nav-->
      <nav class="d-flex mb-3 mb-sm-4"><a class="nav-link text-muted fs-sm fw-normal ps-0 pe-2 py-2 me-4" href="#">고객 지원</a><a class="nav-link text-muted fs-sm fw-normal ps-0 pe-2 py-2 me-4" href="#">Privacy</a><a class="nav-link text-muted fs-sm fw-normal ps-0 pe-2 py-2 me-sm-4" href="#">Terms of use</a></nav>
      <!-- Language / currency switcher-->
      <div class="dropdown mb-4">
        <button class="btn btn-outline-secondary dropdown-toggle px-4" type="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false"><img class="me-2" src="/assets/img/flags/en.png" width="18" alt="English / USD">Eng / USD</button>
        <div class="dropdown-menu dropdown-menu-end my-1">
          <div class="dropdown-item">
            <select class="form-select form-select-sm">
              <option value="usd">$ USD</option>
              <option value="eur">€ EUR</option>
              <option value="ukp">£ UKP</option>
              <option value="jpy">¥ JPY</option>
            </select>
          </div><a class="dropdown-item pb-1" href="#"><img class="me-2" src="/assets/img/flags/fr.png" width="18" alt="Français">Français</a><a class="dropdown-item pb-1" href="#"><img class="me-2" src="/assets/img/flags/de.png" width="18" alt="Deutsch">Deutsch</a><a class="dropdown-item" href="#"><img class="me-2" src="/assets/img/flags/it.png" width="18" alt="Italiano">Italiano</a>
        </div>
      </div>
    </div>
    <!-- Logo + Socials + Cards-->
    <div class="d-sm-flex align-items-center pt-4">
      <div class="d-sm-flex align-items-center pe-sm-2"><a class="navbar-brand d-inline-flex align-items-center me-sm-5 mb-4 mb-sm-0" href="index.html"><span class="text-primary flex-shrink-0 me-2">

            <div class="text-nowrap mb-4 mb-sm-0"><a class="btn btn-icon btn-sm btn-secondary btn-telegram rounded-circle mx-2 ms-sm-0 me-sm-3" href="#"><i class="ai-telegram"></i></a><a class="btn btn-icon btn-sm btn-secondary btn-instagram rounded-circle mx-2 ms-sm-0 me-sm-3" href="#"><i class="ai-instagram"></i></a><a class="btn btn-icon btn-sm btn-secondary btn-facebook rounded-circle mx-2 ms-sm-0 me-sm-3" href="#"><i class="ai-facebook"></i></a><a class="btn btn-icon btn-sm btn-secondary btn-pinterest rounded-circle mx-2 ms-sm-0 me-sm-3" href="#"><i class="ai-pinterest"></i></a></div>
            </span></a>
      </div><img class="ms-sm-auto" src="/assets/img/shop/footer-cards.png" width="187" alt="Accepted cards">
    </div>
  </div>
  <div class="pt-5 pt-lg-0"></div>
</footer>
<!-- Back to top button--><a class="btn-scroll-top" href="#top" data-scroll>
  <svg viewBox="0 0 40 40" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
    <circle cx="20" cy="20" r="19" fill="none" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="10"></circle>
  </svg><i class="ai-arrow-up"></i></a>
<!-- Vendor scripts: js libraries and plugins-->
<script src="/assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="/assets/vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script src="/assets/vendor/nouislider/dist/nouislider.min.js"></script>
<script src="/assets/vendor/swiper/swiper-bundle.min.js"></script>
<!-- Main theme script-->
<script src="/assets/js/theme.min.js"></script>
<!-- Custom script: 주문결제 추가 기능 -->
<script>

  // 로그인 연장 및 남은 시간 표시 기능
  $(document).ready(function () {
    // 서버에서 남은 시간을 밀리초로 가져옵니다.
    let remainingTime = parseInt($('#remainingTime').data('remaining-time'), 10);

    // 남은 시간을 화면에 업데이트하는 함수입니다.
    function updateRemainingTime() {
      if (remainingTime > 0) {
        const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);
        $('#remainingTime').text(minutes + "분 " + seconds + "초");
        remainingTime -= 1000;
      } else {
        $('#remainingTime').text("토큰 만료됨");
      }
    }

    // 1초마다 남은 시간을 업데이트합니다.
    setInterval(updateRemainingTime, 1000);

    // 로그인 연장 버튼 클릭 시 토큰을 연장하는 AJAX 요청을 보냅니다.
    $('#extendTokenBtn').click(function () {
      $.post("/extend-token", function (data) {
        if (data.jwtToken) {
          remainingTime = data.remainingTime;
          updateRemainingTime();
        } else {
          alert('토큰이 만료되었습니다. 다시 로그인 해주세요.');
          window.location.href = '/account-signin';
        }
      }).fail(function () {
        alert('토큰이 만료되었습니다. 다시 로그인 해주세요.');
        window.location.href = '/account-signin';
      });
    });

    // 페이지가 로드되면 남은 시간을 초기화합니다.
    updateRemainingTime();

    // 페이지 로드 시 토큰의 유효성을 검사하는 AJAX 요청을 보냅니다.
    $.ajax({
      url: "/check-token",
      method: "GET",
      success: function (data) {
        if (data.valid) {
          remainingTime = data.remainingTime; // 토큰이 유효할 경우 남은 시간을 갱신합니다.
          updateRemainingTime();
        } else {
          alert('토큰이 만료되었습니다. 다시 로그인 해주세요.');
          window.location.href = '/account-signin';
        }
      },
      error: function (xhr) {
        if (xhr.status === 401) {
          alert('토큰이 만료되었습니다. 다시 로그인 해주세요.');
          window.location.href = '/account-signin';
        }
      }
    });
  });

  // 로그인 연장 및 남은 시간 표시 기능 끝

  function execDaumPostcode() {
    new daum.Postcode({
      oncomplete: function (data) {
        document.getElementById('newZipCode').value = data.zonecode;
        document.getElementById('newAddress').value = data.roadAddress ? data.roadAddress : data.jibunAddress;
        document.getElementById('newAddress').disabled = false;
        document.getElementById('newDetailAddress').focus();
      }
    }).open();
  }

  let editTarget = null;
  let selectedPaymentMethod = '';

  function showNewAddressForm() {
    // 모달을 열기 전에 입력 필드가 존재하는지 확인하고 초기화 성공
    const newRecipientInput = document.getElementById('newRecipient');
    if (!newRecipientInput) {
      console.error('newRecipient input field not found!');
    } else {
      newRecipientInput.value = ''; // 값을 공백으로 초기화
      console.log('newRecipient input field found:', newRecipientInput);
    }

    // 모달 열기
    $('#newAddressModal').modal('show');
  }

  // jQuery를 사용하여 모달이 열린 후 이벤트를 추가하여 필드가 초기화되었는지 확인
  $('#newAddressModal').on('shown.bs.modal', function () {
    const newRecipientInput = document.getElementById('newRecipient');
    if (newRecipientInput) {
      newRecipientInput.value = ''; // 모달이 열릴 때 값을 공백으로 초기화
      console.log('Modal shown. newRecipient input field reset to empty.');
    }
  });

  function selectAddress(card) {
    const details = card.querySelector('.address-details');
    const nameRecipient = details.querySelector('strong').innerText.split(' ');
    const name = nameRecipient[0];
    const recipient = nameRecipient[1];
    const addressText = details.querySelector('p').innerHTML.split('<br>');
    const addressParts = addressText[0].split(' ');
    const zipCode = addressParts[0];
    const address = addressParts.slice(1).join(' '); // 도로명 주소까지만
    const detailAddress = addressText[1]; // 상세주소
    const phone = addressText[2];

    document.getElementById('recipientNameInput').value = recipient;
    document.getElementById('postcode').value = zipCode;
    document.getElementById('address').value = address;
    document.getElementById('detailAddress').value = detailAddress;
    document.getElementById('phoneNumber').value = phone;

    $('#addressModal').modal('hide');
  }
  function addNewAddress() {
    const name = document.getElementById('newName').value;
    const recipient = document.getElementById('newRecipient').value;
    const zipCode = document.getElementById('newZipCode').value;
    const address = document.getElementById('newAddress').value;
    const detailAddress = document.getElementById('newDetailAddress').value;
    const phone = document.getElementById('newPhone').value;
    const isDefault = document.getElementById('defaultAddressCheck').checked;

    if (!name || !recipient || !zipCode || !address || !detailAddress || !phone) {
      alert('모든 필드를 입력해주세요.');
      return;
    }

    // 이미 기본 배송지가 있는지 확인
    if (isDefault) {
      const existingDefault = document.querySelectorAll('.address-card .badge');
      existingDefault.forEach(badge => {
        if (badge.innerText === '기본배송지') {
          badge.remove();
        }
      });
    }

    if (editTarget) {
      editTarget.querySelector('.address-details').innerHTML = `
            <strong>${name} ${recipient}</strong>
            ${isDefault ? '<span class="badge">기본배송지</span>' : ''}
            <span class="badge">택배배송</span>
            <p>${zipCode} ${address}<br>${detailAddress}<br>${phone}</p>
        `;
      editTarget = null;
    } else {
      const addressList = document.getElementById('addressList');
      const newCard = document.createElement('div');
      newCard.className = 'address-card';
      newCard.setAttribute('onclick', 'selectAddress(this)');
      newCard.innerHTML = `
            <div class="address-details">
                <strong>${name} ${recipient}</strong>
                ${isDefault ? '<span class="badge">기본배송지</span>' : ''}
                <span class="badge">택배배송</span>
                <p>${zipCode}<br> ${address}<br>${detailAddress}<br>${phone}</p>
            </div>
            <div>
                <button class="btn-edit" onclick="editAddress(this, event)">
                    <i class="fas fa-edit"></i> 수정
                </button>
                <button class="btn-delete" onclick="deleteAddress(this)">
                    <i class="fas fa-trash-alt"></i> 삭제
                </button>
            </div>
        `;
      addressList.insertBefore(newCard, addressList.firstChild); // 새 주소 카드를 주소 목록의 맨 위에 추가
    }

    // 바인딩된 정보를 메인 화면의 배송지 정보에 업데이트
    document.getElementById('recipientNameInput').value = recipient;
    document.getElementById('postcode').value = zipCode;
    document.getElementById('address').value = address;
    document.getElementById('detailAddress').value = detailAddress;
    document.getElementById('phoneNumber').value = phone;

    // Close modal and clear form fields
    $('#newAddressModal').modal('hide');
    document.getElementById('newName').value = '';
    document.getElementById('newRecipient').value = '';
    document.getElementById('newZipCode').value = '';
    document.getElementById('newAddress').value = '';
    document.getElementById('newDetailAddress').value = '';
    document.getElementById('newPhone').value = '';
    document.getElementById('defaultAddressCheck').checked = false;
    document.getElementById('newAddress').disabled = true;
  }

  //ㅇㅇㅇㅇㅇㅇㅇㅇ



  function editAddress(button, event) {
    // 이벤트 전파 중단 (카카오 API 실행됨)
    event.stopPropagation();
    event.preventDefault();

    const card = button.parentElement.parentElement;
    const details = card.querySelector('.address-details');
    const nameRecipient = details.querySelector('strong').innerText.split(' ');
    const name = nameRecipient[0];
    const recipient = nameRecipient[1];
    const badges = details.querySelectorAll('.badge');
    const isDefault = badges.length > 1; // Assume the first badge is "택배배송"
    const addressText = details.querySelector('p').innerText.split('\n');
    const addressParts = addressText[0].split(' ');
    const zipCode = addressParts[0];
    const address = addressParts.slice(1).join(' ');
    const detailAddress = addressText[1]; // 상세주소
    const phone = addressText[2];

    document.getElementById('newName').value = name;
    document.getElementById('newRecipient').value = recipient;
    document.getElementById('newZipCode').value = zipCode;
    document.getElementById('newAddress').value = address;
    document.getElementById('newDetailAddress').value = detailAddress;
    document.getElementById('newPhone').value = phone;
    document.getElementById('defaultAddressCheck').checked = isDefault;

    editTarget = card;

    $('#newAddressModal').modal('show');
  }

  function deleteAddress(button) {
    const card = button.parentElement.parentElement;
    card.parentElement.removeChild(card);
  }

  // 초기 설정
  document.addEventListener("DOMContentLoaded", function () {
    selectPaymentMethod('kakaopay'); // 기본 결제 방법 설정

    // 로그인한 사용자의 기본 배송지 정보를 설정
    const defaultAddressCard = document.querySelector('.address-card .badge');
    if (defaultAddressCard) {
      const details = defaultAddressCard.closest('.address-details');
      const nameRecipient = details.querySelector('strong').innerText.split(' ');
      const recipient = nameRecipient.slice(1).join(' '); // 첫 번째 이름(보내는 분의 이름)을 제외한 나머지를 받는 분으로 설정
      const addressText = details.querySelector('p').innerHTML.split('<br>');
      const zipCode = addressText[0].trim(); // 우편번호
      const address = addressText[1].trim(); // 도로명 주소
      const detailAddress = addressText[2].trim(); // 상세주소
      const phone = addressText[3].trim(); // 휴대폰 번호

      document.getElementById('recipientNameInput').value = recipient;
      document.getElementById('postcode').value = zipCode;
      document.getElementById('address').value = address;
      document.getElementById('detailAddress').value = detailAddress;
      document.getElementById('phoneNumber').value = phone;
    }
  });





  function confirmAddress() {
    $('#addressModal').modal('hide');
  }

  function toggleCustomMessageInput() {
    var shippingRequest = document.getElementById('shippingRequest').value;
    var customMessageContainer = document.getElementById('customMessageContainer');
    if (shippingRequest === '직접입력') {
      customMessageContainer.style.display = 'flex';
    } else {
      customMessageContainer.style.display = 'none';
    }
  }

  // 결제 방법 안내 이벤트 처리
  function selectPaymentMethod(method) {
    // 모든 메시지 숨기기
    document.querySelector('.card-selection').style.display = 'none';
    document.querySelector('.naverpay-message').style.display = 'none';
    document.querySelector('.banktransfer-message').style.display = 'none';
    document.querySelector('.kakaopay-message').style.display = 'none';

    // 선택된 결제 방법에 따라 메시지 표시
    if (method === 'kakaopay') {
      document.querySelector('.kakaopay-message').style.display = 'block';
    } else if (method === 'banktransfer') {
      document.querySelector('.banktransfer-message').style.display = 'block';
    } else if (method === 'creditcard') {
      document.querySelector('.card-selection').style.display = 'block';
    } else if (method === 'naverpay') { //naverpay //naverpay-message
      document.querySelector('.naverpay-message').style.display = 'block';
    }

    // 선택된 결제 방법에 테두리 색상 추가
    document.querySelectorAll('.payment-methods button').forEach(button => {
      button.classList.remove('selected');
    });
    document.querySelector(`.payment-methods button[onclick="selectPaymentMethod('${method}')"]`).classList.add('selected');

    selectedPaymentMethod = method; // 선택한 결제 방법 저장
  }
  // 달력 날짜 처리
  document.addEventListener('DOMContentLoaded', function() {
    // 현재 날짜를 가져옴
    var today = new Date();
    // 2일을 더함
    today.setDate(today.getDate() + 2);

    // YYYY-MM-DD 형식으로 변환
    var dd = String(today.getDate()).padStart(2, '0');
    var mm = String(today.getMonth() + 1).padStart(2, '0'); // 1월은 0부터 시작
    var yyyy = today.getFullYear();

    var minDate = yyyy + '-' + mm + '-' + dd;

    // input 요소에 min 속성 설정
    document.getElementById('deliveryDate').setAttribute('min', minDate);
  });
  // 달력 날짜 처리

  //결제 스크립트
  // 포트원(PortOne) 초기화 (가맹점 고유 코드)
  IMP.init("imp22862720");  // 실제 가맹점 식별 코드를 넣으세요

  // 결제 스크립트
  document.getElementById('paymentForm').addEventListener('submit', function(event) {

    if (event.submitter && event.submitter.classList.contains('btn-edit')) {
      return;
    }

    event.preventDefault();

    const totalPriceElement = document.getElementById('totalPriceValue') || { value: '0' };
    const impUidElement = document.getElementById('impUid') || { value: '' };
    const merchantUidElement = document.getElementById('merchantUid') || { value: 'order_' + new Date().getTime() };
    const paidAmountElement = document.getElementById('paidAmount') || { value: '0' };
    const productNameElement = document.getElementById('productName') || { value: '' };
    const phoneElement = document.getElementById('phoneNumber') || { value: '' };
    const emailElement = document.getElementById('email') || { value: '' };
    const postcodeElement = document.getElementById('postcode') || { value: '' };
    const addressElement = document.getElementById('address') || { value: '' };
    const detailAddressElement = document.getElementById('detailAddress') || { value: '' };
    const deliveryDateElement = document.getElementById('deliveryDate') || { value: '' };
    const shippingRequestElement = document.getElementById('shippingRequest') || { value: '' };
    const customMessageElement = document.getElementById('customMessage') || { value: '' };

    // 사용자 입력 필드에서 값을 가져와 히든 필드에 설정
    const recipientNameInput = document.getElementById('recipientNameInput') || { value: '' };
    const recipientNameElement = document.getElementById('recipientName');
    recipientNameElement.value = recipientNameInput.value;

    const amount = parseInt(totalPriceElement.value.replace(' 원', '').replace(',', ''), 10) || 0;

    const orderItems = [];
    document.querySelectorAll('.order-item').forEach(item => {
      const productId = item.getAttribute('data-product-id');
      const productName = item.getAttribute('data-product-name');
      const quantity = item.getAttribute('data-quantity');
      const price = item.getAttribute('data-price');
      const totalPrice = quantity * price;

      orderItems.push({
        productId: productId,
        productName: productName,
        quantity: parseInt(quantity),
        price: parseInt(price),
        totalPrice: totalPrice
      });
    });

    if (amount === 0) {
      console.error('총 결제 금액이 유효하지 않습니다.');
      return;
    }

    // 선택된 결제 방법이 banktransfer인지 확인
    if (selectedPaymentMethod === 'banktransfer') {
      // 결제 정보 객체 생성
      const orderDto = {
        impUid: '',
        merchantUid: merchantUidElement.value,
        amount: amount,
        totalPrice: amount,
        productName: productNameElement.value,
        phone: phoneElement.value,
        email: emailElement.value,
        postcode: postcodeElement.value,
        address: addressElement.value,
        detailAddress: detailAddressElement.value,
        recipientName: recipientNameElement.value,
        phoneNumber: phoneElement.value,
        pointAmount: parseInt(document.getElementById('pointAmount').value),
        deliveryDate: deliveryDateElement.value,
        deliveryRequest: shippingRequestElement.value === '직접입력' ? customMessageElement.value : shippingRequestElement.value,
        orderItems: orderItems
      };

      // fetch를 사용하여 서버로 데이터를 전송
      fetch('/create-payment', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(orderDto)
      })
              .then(response => {
                if (response.redirected) {
                  window.location.href = response.url;
                } else {
                  return response.json();
                }
              })
              .then(data => {
                console.log('Success:', data);
                alert('결제 정보가 성공적으로 전송되었습니다.');
              })
              .catch((error) => {
                console.error('Error:', error);
                alert('결제 정보 전송에 실패했습니다.');
              });
    } else {
      IMP.request_pay({
        pg: selectedPaymentMethod,
        pay_method: 'card',
        merchant_uid: 'order_' + new Date().getTime(),
        name: productNameElement.value || 'Order Payment',
        amount: amount,
        buyer_email: emailElement.value || 'test@example.com',
        buyer_name: recipientNameElement.value || '홍길동',
        buyer_tel: phoneElement.value || '010-1234-5678',
        buyer_addr: addressElement.value + ' ' + detailAddressElement.value || '서울특별시 강남구 테헤란로 123',
        buyer_postcode: postcodeElement.value || '12345',
      }, function(rsp) {
        if (rsp.success) {
          impUidElement.value = rsp.imp_uid;
          merchantUidElement.value = rsp.merchant_uid;
          paidAmountElement.value = rsp.paid_amount;

          const orderDto = {
            impUid: rsp.imp_uid,
            merchantUid: rsp.merchant_uid,
            amount: rsp.paid_amount,
            totalPrice: amount,
            productName: productNameElement.value,
            phone: phoneElement.value,
            email: emailElement.value,
            postcode: postcodeElement.value,
            address: addressElement.value,
            detailAddress: detailAddressElement.value,
            recipientName: recipientNameElement.value,
            phoneNumber: phoneElement.value,
            pointAmount: parseInt(document.getElementById('pointAmount').value),
            deliveryDate: deliveryDateElement.value,
            deliveryRequest: shippingRequestElement.value === '직접입력' ? customMessageElement.value : shippingRequestElement.value,
            orderItems: orderItems
          };

          // AJAX 요청을 통해 서버로 orderDto를 전송
          fetch('/create-payment', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(orderDto)
          })
                  .then(response => {
                    if (response.redirected) {
                      window.location.href = response.url;
                    } else {
                      return response.json();
                    }
                  })
                  .then(data => {
                    console.log('Success:', data);
                  })
                  .catch((error) => {
                    console.error('Error:', error);
                    alert('결제에 실패했습니다.');
                  });
        } else {
          alert('결제에 실패했습니다. 에러 내용: ' + rsp.error_msg);
        }
      });
    }
  });
  //모달 undefined  문제 완료 공백처리

</script>


</body>
</html>
